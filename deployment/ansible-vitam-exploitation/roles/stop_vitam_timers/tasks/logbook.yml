---

# Logbook reconstruction
- name: Make sure logbook reconstruction timer is stopped
  systemd:
    name: "vitam-logbook-reconstruction.timer"
    state: "stopped"

# Wait for the service to be stopped
- name: Wait for vitam-logbook-reconstruction service to be stopped
  wait_for_service:
    name: "vitam-logbook-reconstruction.service"
    state: "stopped"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

# Logbook traceability
- name: Make sure Secure logbook systemd timers are stopped
  systemd:
    name: "{{ item }}"
    state: "stopped"
  with_items:
    - vitam-traceability-lfc-objectgroup.timer
    - vitam-traceability-lfc-unit.timer
    - vitam-traceability-operations.timer
    - vitam-traceability-audit.timer

# Wait for the service to be stopped
- name: Wait for Secure logbook systemd services to be stopped
  wait_for_service:
    name: "{{ item }}"
    state: "stopped"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"
  with_items:
    - vitam-traceability-lfc-objectgroup.service
    - vitam-traceability-lfc-unit.service
    - vitam-traceability-operations.service
    - vitam-traceability-audit.service
