---
- name: Ensure storage accesslog backup systemd timer is stopped
  systemd:
    name: "vitam-storage-accesslog-backup.timer"
    state: "stopped"
  when: "'vitam-storage-accesslog-backup.timer' in ansible_facts.services"

# Wait for the service to be stopped
- name: Wait for vitam-storage-accesslog-backup service to be stopped
  wait_for_service:
    name: "vitam-storage-accesslog-backup.service"
    state: "stopped"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"
  when: "'vitam-storage-accesslog-backup.service' in ansible_facts.services"

- name: Ensure storage backup systemd timer is stopped
  systemd:
    name: "vitam-storage-log-backup.timer"
    state: "stopped"
  when: "'vitam-storage-log-backup.timer' in ansible_facts.services"

# Wait for the service to be stopped
- name: Wait for vitam-storage-log-backup service to be stopped
  wait_for_service:
    name: "vitam-storage-log-backup.service"
    state: "stopped"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"
  when: "'vitam-storage-log-backup.service' in ansible_facts.services"

- name: Ensure storage traceability systemd timer is stopped
  systemd:
    name: "vitam-storage-log-traceability.timer"
    state: "stopped"
  when: "'vitam-storage-log-traceability.timer' in ansible_facts.services"

# Wait for the service to be stopped
- name: Wait for vitam-storage-log-traceability service to be stopped
  wait_for_service:
    name: "vitam-storage-log-traceability.service"
    state: "stopped"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"
  when: "'vitam-storage-log-traceability.service' in ansible_facts.services"
