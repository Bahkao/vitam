---

- hosts: hosts-kibana-log
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: kibana
    hote: "{{ ip_admin }}"
    port_check: "{{ kibana.log.port }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-logstash
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: logstash
    hote: "{{ ip_admin }}"
    port_check: "{{logstash.port}}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-elasticsearch-log
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-elasticsearch-log
    hote: "{{ ip_admin }}"
    port_check: "{{ elasticsearch.log.port_tcp }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

# consul stop
- hosts: vitam
  gather_facts: no
  roles:
    - { role: service, when:  consul_disabled is not defined or consul_disabled |lower != 'true' }
  vars:
    state: stopped
    name: vitam-consul

- hosts: hosts-consul-server
  gather_facts: no
  serial: 1
  roles:
    - service
  vars:
    state: stopped
    name: vitam-consul

- hosts: hosts-cerebro
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-elasticsearch-cerebro

- hosts: hosts-mongos-data
  gather_facts: no
  roles:
    - { role: docker, when: "inventory_hostname not in single_vm_hostnames" }
  vars:
    name: "mongo-express"
    state: stopped
    group_name: "hosts-mongos-data"

- hosts: hosts-mongos-offer
  gather_facts: no
  roles:
    - { role: docker, when: "inventory_hostname not in single_vm_hostnames" }
  vars:
    name: "mongo-express"
    state: stopped
    group_name: "hosts-mongos-offer"

- hosts: hosts-dev-tools
  gather_facts: no
  roles:
    - { role: docker, when: "inventory_hostname not in single_vm_hostnames" }
  vars:
    name: "elasticsearch-head"
    state: stopped
