---

- import_playbook: stop_vitam_timers.yml

- import_playbook: stop_vitam_ihm.yml

- import_playbook: stop_external.yml

- hosts: hosts-ingest-external
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-siegfried

- hosts: hosts-ingest-internal
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-ingest-internal
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.ingestinternal.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"


- hosts: hosts-access-internal
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-access-internal
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.accessinternal.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-worker
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-worker
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.worker.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-worker
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-siegfried

- hosts: hosts-batch-report
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-batch-report
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.batchreport.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-processing
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-processing
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.processing.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-security-internal
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-security-internal
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.security_internal.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-functional-administration
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-functional-administration
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.functional_administration.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-logbook
  gather_facts: no
  roles:
    - service
  vars:
    state: stopped
    name: vitam-logbook
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.logbook.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-workspace
  roles:
    - service
  vars:
    state: stopped
    name: vitam-workspace
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.workspace.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-metadata
  roles:
    - service
  vars:
    state: stopped
    name: vitam-metadata
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.metadata.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-storage-engine
  roles:
    - service
  vars:
    state: stopped
    name: vitam-storage
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.storageengine.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-storage-offer-default
  roles:
    - service
  vars:
    state: stopped
    name: vitam-offer
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.storageofferdefault.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-kibana-data
  roles:
    - service
  vars:
    state: stopped
    name: kibana
    hote: "{{ ip_service }}"
    port_check: "{{ kibana.data.port }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

- hosts: hosts-kibana-data
  roles:
    - service
  vars:
    state: stopped
    name: vitam-elastic-kibana-interceptor
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.elastickibanainterceptor.port_service }}"
    timeout: "{{ vitam_defaults.services.stop_timeout }}"

# Databases stop

- import_playbook: stop_elasticsearch_data.yml

- import_playbook: stop_mongodb.yml
