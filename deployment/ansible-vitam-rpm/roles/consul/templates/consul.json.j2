{
    "data_dir": "{{ consul_folder_data }}",
    "log_level": "INFO",
    "enable_syslog": true,

{% if server %}
   "bootstrap_expect": {{ groups['hosts-consul-server']|length }},
   "server": true,
   "ui": true,
   "addresses" : {
      "http": "0.0.0.0"
   },
{% endif %}

  "recursors": [ "{{dns_server}}" ],
  "domain": "{{consul_domain}}",
  "datacenter": "{{environnement}}-dc1",
  "retry_join": [ "{{ groups['hosts-consul-server']|join('", "') }}" ],
  "retry_interval": "10s",
  "ports": {
      "dns" : 53
  }
}
