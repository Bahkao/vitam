    Principes communs et environnement des services
###############################################


Principes relatifs aux composants délivrés
==========================================

Principles relatifs aux services VITAM
**************************************

Les services développés dans le cadre du projet VITAM interagissent avec un ensemble de composants externes dédiés à son exploitation :

.. figure:: images/principles-vitamservice.*
:align: center

    Environnement d'un service VITAM

Les interactions entre ces services et leur environnement se séparent essentiellement en 2 grandes familles :

* Les interactions avec des services externes : on y trouve :

    - L'accès aux packages logiciels pour installation (Cf. :doc:`20-principles-packaging`) ;

    - Le déploiement, permettant à un outil central d'orchestrer le déploiement de la solution (Cf. :doc:`30-principles-deployment`) ;

    - L'annuaire de services, permettant à chaque service de localiser les services dont il dépend (Cf. :doc:`10-principles-networking`) ;

    - Le monitoring, avec (Cf. :doc:`40-principles-monitoring`) :

        + l'accès offert au système de supervision aux données de monitoring exposées par les services ;
        + l'export des logs applicatifs vers le sous-système de gestion des logs ;

* Les interactions locales au serveur, notamment avec des fichiers (dont la nomenclature est précisée dans :doc:`une section dédiée <01-principles-users-rights>`) :

    - L'installation, avec l'exécution du gestionnaire de paquets de l'OS (Cf. :doc:`20-principles-packaging`) ;
      
    - La gestion des fichiers de configuration de l'application via l'outil de déploiement (Cf. :doc:`30-principles-deployment`) ;

    - Le démarrage / arrêt des services (Cf. :doc:`50-principles-technical-administration`) ;
    
    - La sauvegarde / restauration des données applicatives (Cf. :ref:`data-management`).


Principes relatifs aux :term:`COTS`
***********************************

.. tip:: Les :term:`COTS` comprennent notamment les moteurs de base de données (ex: MongoDB)

De manière générale, les distributions binaires utilisées sont celles fournies nativement par les distribution linux, ou à défaut les paquets fournis par l'éditeur du logiciel.

Les principes édictés ci-dessus s'appliquent partiellement aux :term:`COTS` :

* Concernant les interactions avec des services externes :

    - **Respect des principes VITAM** : l'accès aux packages logiciels ;

    - **Respect des principes VITAM** : les principles et outillage de déploiement ;

    - **Utilisation des capacités natives du :term:`COTS`** : localisation du service

    - Le monitoring dépend du :term:`COTS`, et peut s'écarter fotement des principes respectés par les services VITAM, notamment en s'appuyant sur les API de monitoring et le format des fichiers de log :

        + **Utilisation des capacités natives du :term:`COTS`** : les API de monitoring seront les API natives du :term:`COTS` ;
        + **Respect partiel des principes VITAM**: les logs du :term:`COTS` seront pris en charge par le sous-système de gestion des logs ; par contre, le format des logs (et notamment les champs exposés) sera différent.

* Les interactions locales au serveur, notamment avec des fichiers (dont la nomenclature est précisée dans :doc:`une section dédiée <01-principles-users-rights>`) :

    - **Respect des principes VITAM** : format de packaging et outil utilisé pour l'installation
      
    - **Respect des principes VITAM** : gestion des fichiers de configuration ;

    - **Respect des principes VITAM** : démarrage / arrêt des services est identique ;
    
    - **Utilisation des capacités natives du COTS** : sauvegarde / restauration des données 


.. _data-management:

Gestion des données
===================

.. todo:: Sujet à adresser (mentionner les grandes lignes des principes de stockage / backup / restauration des données)

.. Utilisation des outils fournis (ex: mongodump pour la sauvegarde de mongo) à aborder dans la description des services (dans l'architecture technique)


