Utilisateurs, dossiers & droits
###############################

.. préciser les user / groupes owners, notamment concernant les besoins d'accès / de configuration / d'audit ; attention : à mettre en cohérence avec les utilsiateurs permettant le lancement / arrêt des services

Utilisateurs et groupes d'exécution
===================================

.. Préciser le principe pris : séparation des rôles admin sys et admin app et admin bdd, et les droits vus pour chacun

Les utilisateurs et groupes suivants sont ajoutés par l'installation de la solution VITAM.

.. todo:: Les uid et gid seront définis dans une prochaine version de ce document.

Groupes
*******

* ``vitam`` : il s'agit du groupe primaire des utilisateurs de service
* ``vitam-admin`` : il s'agit du groupe d'utilisateurs ayant les droits "sudo" permettant le le lancement des services VITAM
* ``vitamdb-admin`` : il s'agit du groupe d'utilisateurs ayant les droits "sudo" permettant le le lancement des services VITAM stockant de la donnée.


Utilisateurs
************

* utilisateur de service ; les processus VITAM tournent sous cet utilisateur. Leur login est désactivé.

   - ``vitam`` : pour les services ne stockant pas les données 
   - ``vitamdb`` : pour les services stockant de la données (Ex : MongoDB et ElasticSearch)
     

.. A définir si cela inclut aussi le moteur de données et de stockage)


Arborescence de fichiers
========================

Services VITAM
**************

Pour un service d'id ``<service_id>``, Les fichiers et dossiers impactés par VITAM sont les suivants :

  + ``/vitam/<service_id>`` : répertoire racine des fichiers du service

    * ``app``  : fichiers de ressources (non-jar) requis pour l’application (ex: .war)
    * ``bin``  : Répertoire des scripts d'exploitation du module (start/stop/status/backup)
    * ``conf`` : Fichiers de configuration
    * ``lib``  : Fichiers binaires (ex: jar)
    * ``log``  : Logs du composant
    * ``data`` : Données du composant
    * ``tmp``  : Données temporaires produites par l'application

.. todo:: Les fichiers de contrôle des services seront définis dans une prochaine version de ce document

* Droits par défaut : 

  + Fichiers standards :

      * Owner : ``vitam`` (ou `vitamdb``)
      * Group owner : ``vitam``
      * Droits : 0640
    
  + Fichiers exécutables et répertoires :
  
      * Owner : ``vitam`` (ou ``vitamdb``)
      * Group owner : ``vitam``
      * Droits : 0750

.. A faire : valider les owners et droits pour que les bons rôles puissent avoir accès aux bons dossiers, uniquement en lecture ou en lecture/écriture.

COTS
****

Les :term:`COTS` utilisent la même nomenclature de répertoires et utilisateurs que les services VITAM, aux exceptions suivantes :

* les fichiers binaires et bibliothèques utilisent les dossiers de l'installation du paquet natif ;

