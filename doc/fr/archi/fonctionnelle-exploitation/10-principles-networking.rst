Principes sur les communications inter-services et le clustering
################################################################

.. todo:: A rajouter : principes d'interaction avec les équipements réseau actifs.


Gestion des clusters applicatifs
================================

.. todo:: Sujet à adresser

.. Principe : les clients ne voient pas la topologie des serveurs, qui est confiée à un composant tiers.

.. 
   A définir :

   * Les principes de haute-disponibilité : sur les services stateless, sur les services stateful (si une certaine affinité de session est requise).
   * Les principes de haute-disponibilité pour MongoDB

.. curseur MongoDB pour metadata : ATTENTION ! L'idée serait plutôt d'intégrer l'id du serveur (ou le nom de cette instance de service, résolvable par le DNS) qui porte le curseur dans le token remonté jusqu'au SIA, et on attend que le SIA nous renvoie ce token. Charge à access de gérer le cas où le serveur portant le token est mort.

.. A voir dans consul : résolution des noms d'instance de service VS noms de service de cluster

.. processing : la plus grosse partie de sa résilience est dans le workspace ; mais n'y-t-il point un autre besoin ?


Annuaire de services (service registry)
=======================================

.. todo:: Sujet à compléter

La découverte des services est réalisée via l'utilisation du protocole DNS.

.. note::
   Les avantages de l'utilisation de ce protocole sont multiples :

   * Simple et éprouvé
   * Connu des équipes d'exploitation

Chaque cluster de service possède un nom unique de service (différent des noms d'hôtes sur lesquels il est hébergé) qui est résolu par un serveur DNS configuré lors du déploiement. Tout hôte portant un service VITAM devra utiliser ce serveur DNS par défaut.

L'installation et configuration du serveur DNS applicatif est intégré à VITAM


.. Après, la grande question reste : Consul VS PowerDNS (pour la beta uniquement) ?
  
.. Avantages de Consul VS une solution de DNS statique :

.. * Gestion dynamique des services ; couplage fort avec le supervision de ces noeuds ;
.. * Possibilité de l'utiliser pour faire un load-balancing et failover simple (à valider en fonction du bon fonctionnement des TTL DNS) ;
.. * Possibilité de l'utiliser comme source de données pour configurer un/plusieurs LB tiers
.. * Possibilité de l'utiliser pour une solution de monitoring simple.
  
.. Inconvénients :

.. * Brique supplémentaire à déployer, configurer et maintenir
  
.. Autre question : discovery des services externes % internes, et inversement.
