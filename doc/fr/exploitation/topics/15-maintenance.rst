Interruption / maintenance
##########################


Procédure d'arrêt
=================

Cette procédure décrit la cinématique d'arrêt de la plate-forme ; les commandes pour chaque composant sont détaillées plus bas dans ce même document.


.. note:: Il est conseillé de n'arrêter les bases de données qu'une fois les composants applicatifs arrêtés.

.. csv-table:: Cinématique d'arrêt de VITAM
   :header: "Composant", "Ordre d'arrêt","Résultat OK pour passer à l'étape suivante"
   :widths: 15, 5,10

   "ihm-demo","1",""
   "access","2",""
   "processing","3",""
   "workspace","4",""
   "metadata","5",""
   "storage-engine","6",""
   "storage-offer-xxx","7",""
   "logbook","8",""
   "kibana","9",""
   "logstash","10",""
   "ingest-external","11",""
   "elasticsearch logs","12",""
   "elasticsearch vitam","13",""
   "mongo","14",""


Un playbook ansible d'arrêt de VITAM est fourni, sous ``deployment/ansible-vitam-exploitation``  (fichier ``stop_vitam.yml``), pour réaliser de façon automatisée les actions nécessaires.

.. todo:: prévoir une page de redirection de :term:`VITAM` indisponible ? autre ?


Procédure de démarrage
======================

Le pré-requis est le bon fonctionnement des partitions hébergeant :term:`VITAM`.



.. csv-table:: Cinématique de démarrage de :term:`VITAM`
   :header: "Composant", "Ordre","pour passer à l'étape suivante"
   :widths: 15, 5,10

   "ihm-demo","14",""
   "access","13",""
   "processing","12",""
   "workspace","11",""
   "metadata","10",""
   "storage-engine","9",""
   "storage-offer-xxx","8",""
   "logbook","7",""
   "kibana","6",""
   "logstash","5",""
   "ingest-external","4",""
   "elasticsearch logs","3",""
   "elasticsearch vitam","2",""
   "mongo","1",""


.. todo:: enlever une éventuelle page de redirection

Un playbook ansible de démarrage de VITAM est fourni, sous ``deployment/ansible-vitam-exploitation`` (fichier ``start_vitam.yml``), pour réaliser de façon automatisée les actions nécessaires.


Mise à jour des certificats
===========================

Les certificats générés par les scripts de création d'une PKI interne à VITAM ont une durée de 10 ans pour les "CA", 3 ans pour les intermédiaires.

.. todo:: La mise à jour des certificats associés aux composants externes sera décrite dans une prochaine version de ce document.
