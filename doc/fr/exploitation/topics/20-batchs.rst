Batchs et traitements
#####################


Curator
========

Il existe des jobs Curator de :

- fermeture d'index
- suppression d'index fermés

Ces jobs sont lancés via ``crontab`` toutes les nuits.

Sécurisation des journaux d'opérations
========================================

Un `timer` systemd a été mis au point pour réaliser ces actions :

    - :ref:`systemd_timer_trc_ope`


Sécurisation des cycles de vie
===============================

Des `timers` systemd ont été mis au point pour réaliser ces actions :

    - :ref:`systemd_timer_lfc_unit`
    - :ref:`systemd_timer_lfc_og`

.. TODO: faire mieux, là aussi

Sécurisation des offres de stockages
=====================================

Des `timers` systemd ont été mis au point pour réaliser ces actions :

    - :ref:`systemd_timer_storage_backup`
    - :ref:`systemd_timer_storage_traceability`

Procédure de changement de fréquence de certains *timers* SystemD
=================================================================

Par défaut, la solution logicielle :term:`VITAM` déploie et active, selon l'usage (site primaire / site secondaire), des *timers* systemD.
Le  *playbook* ansible d'installation de vitam ``ansible-vitam/vitam.yml``, permet d'uniquement modifier la fréquence des *timers* en rajoutant le tag ``update_timers_frequency``.

Pour cela, il faut éditer la section ``vitam_timers``  dans le fichier ``environments/group_vars/all/vitam_vars.yml``.

A l'issue, lancer le *playbook* avec la commande ::

    ansible-playbook -i <inventaire> ansible-vitam/vitam.yml --tags update_timers_frequency --ask-vault-pass

ou bien, si vous utilisez le fichier ``vault_pass.txt`` ::

    ansible-playbook -i <inventaire> ansible-vitam/vitam.yml --tags update_timers_frequency --vault-password-file vault_pass.txt
