<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
  <!-- bundle is required for all punchplatform archives -->
  <id>bundle</id>
  <formats>
    <format>tar.gz</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <fileSets>
  	<!-- Add all vitam-external rpm -->
    <fileSet>
      <directory>../rpm/vitam-external/target</directory>
      <outputDirectory>rpm/vitam-external</outputDirectory>
    </fileSet>
    <!-- Add "native" vitam-product rpm -->
    <fileSet>
      <directory>../rpm/vitam-product/target</directory>
      <outputDirectory>rpm/vitam-product</outputDirectory>
      <includes>
        <include>**/*.rpm</include>
      </includes>
    </fileSet>
    <!-- Add sources -->
    <fileSet>
      <directory>..</directory>
      <outputDirectory>sources</outputDirectory>
      <includes>
        <include>sources/**</include>
        <include>dev-deployment/**</include>
        <include>integration-test/**</include>
        <include>doc/**</include>
        <include>rpm/**</include>
      </includes>
      <excludes>
      	<!-- IntelliJ project files -->
      	<exclude>**/*.iml</exclude>
		<exclude>**/.idea/**</exclude>
		<!-- Various build files & folders -->
		<exclude>**/build/**</exclude>
		<exclude>**/_build/**</exclude>
		<exclude>**/target/**</exclude>
		<exclude>**/*.class</exclude>
		<exclude>**/*.log</exclude>
		<!-- Eclipse project files -->
		<exclude>**/.classpath</exclude>
		<exclude>**/.project</exclude>
		<exclude>**/.settings/**</exclude>
		<!-- Ansible temp files -->
		<exclude>**/*.retry</exclude>
		<!-- Other -->
		<exclude>**/node_modules/**</exclude>
		<exclude>**/evosuite-tests/**</exclude>
      </excludes>
    </fileSet>
    <!-- Add ansible deployment files -->
    <fileSet>
      <directory>../deployment</directory>
      <outputDirectory>deployment</outputDirectory>
      <excludes>
        <exclude>**/*.retry</exclude>
      </excludes>
    </fileSet>
  </fileSets>
  <dependencySets>
  	<!-- Add documentation files -->
    <dependencySet>
      <outputDirectory>/doc</outputDirectory>
      <unpack>true</unpack>
      <includes>
        <include>fr.gouv.vitam.doc:*:zip</include>
      </includes>
    </dependencySet>
  	<!-- Add java-based vitam-product rpm -->
    <dependencySet>
      <outputDirectory>/rpm/vitam-product</outputDirectory>
      <unpack>false</unpack>
      <includes>
        <include>*:*:rpm</include>
      </includes>
    </dependencySet>
  </dependencySets>
</assembly>